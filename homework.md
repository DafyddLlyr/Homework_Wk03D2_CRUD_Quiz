## CRUD Quiz ##

Use the solution to this afternoon's Property Tracker lab to answer the following questions. Please write your answers under each question, push the file to GitHub, and submit in the usual way.

MVP Questions
In our Property Tracker application:

**Q1. Where are we instantiating instances of the Property class?**

*In the console.rb file, we instantiate them with `Property.new()`.*


**Q2. Where are we defining the SQL that enables us to save the ruby Property object into the database?**

*Within the Property class we have a method which does this - `save()`.*


**Q3. In console.rb, which lines modify the database?**

*Lines 13, 22, 31 (using `save()` and line 33, using `delete()`.*


**Q4. Why do we not define the id of a Property object at the point we instantiate it (‘new it up’)?**

*Because we are allowing our RDBMS (PostgreSQL) to do this each time an item is created. Handling this manually would not be practical or effective.*


**Q5. Where and how do we assign the id (that is generated by the database) to the ruby Property object?**

*This is done on line 32 of property.rb - `@id = db.exec_prepared("save", values)[0]["id"]`. We do this by assigning the id of our Property instance to be equal to the id PostgreSQL has created for the instance when it is added to the database.*


**Q6. Why do we put a guard (an if clause) on the @id attribute in the constructor?**

*This is done as newly created instances do not have an ID until they are assigned one by PostgreSQL - we are not passing one into the constructor function and it would throw an error.*


**Q7. Why are some of the CRUD actions represented by instance methods, and others by class methods?**

*Some of the CRUD actions only run for a single instance (e.g. `save()` or `update()`), and it is only the single instances that should have responsibility for this. Others such as `find_by_id` and `find_by_address` are class methods because they would run through multiple instances for a result and are the responsibility of the class.*


**Q8. What type of data structure is returned by calls to db.exec_prepared()?**

*In the save method, how do we access the id from the returned data structure?
`db.exec_prepared()` returns a PG::Result object. We can access this in the `save()` method as it acts similarly to an array, allowing `[0]` to access the first (only) element and as this item is a hash we can access the id using the key `['id']`.*


**Q9. Why do we use prepared statements when performing database operations?**

*Prepared statements are a way of protecting the database from attacks, specifically SQL injections. The PG gem allows us to sanitise our input and prepare it for entry into our database using the commands `.prepare()` and `.exec_prepared()`.*


Extension Questions
Look at the find_by_id and find_by_address methods in the Property class.


**Q10. What do they take in as their arguments?**

*`find_by_id()` takes an argument of `id` which will be an integer (SERIAL4) which is generated by PostgreSQL. `find_by_address` takes the argument `address` which will be a string containing an address that we are looking to check.*


**Q11. What are their return values?**

*Both functions return an instance of the Property class, a both functions have mapped the PG::Result object into a new instance of Property.*
